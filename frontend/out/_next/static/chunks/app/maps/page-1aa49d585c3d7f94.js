(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[861],{3950:function(e,t,n){Promise.resolve().then(n.bind(n,8751))},8751:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var a=n(7437),o=n(2265),r=n(2020),i=n(7908),l=n(4929),c=n.n(l);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var u=function(e){var t=(0,o.useRef)(e);return t.current=e,t},d=function(e,t){var n;return function(){for(var a=this,o=arguments.length,r=Array(o),i=0;i<o;i++)r[i]=arguments[i];null!==n&&(clearTimeout(n),n=null),n=setTimeout(function(){return e.apply(a,r)},t)}},p=function(e){var t=void 0===e?{}:e,n=t.requestOptions,a=t.debounce,r=t.cache,i=void 0===r?86400:r,l=t.cacheKey,c=void 0===l?"upa":l,p=t.googleMaps,f=t.callbackName,m=t.defaultValue,g=t.initOnMount,v=void 0===g||g,h=(0,o.useState)(!1),x=h[0],b=h[1],y=(0,o.useState)(void 0===m?"":m),w=y[0],_=y[1],C=(0,o.useState)({loading:!1,status:"",data:[]}),j=C[0],S=C[1],k=(0,o.useRef)(),E=u(n),N=u(p),L=(0,o.useCallback)(function(){if(!k.current){var e,t=window.google,n=N.current,a=(null==n?void 0:n.places)||(null==t?void 0:null==(e=t.maps)?void 0:e.places);if(!a){console.error("\uD83D\uDCA1 use-places-autocomplete: Google Maps Places API library must be loaded. See: https://github.com/wellyshen/use-places-autocomplete#load-the-library");return}k.current=new a.AutocompleteService,b(!0)}},[N]),O=(0,o.useCallback)(function(){S({loading:!1,status:"",data:[]})},[]),D=(0,o.useCallback)(function(e){void 0===e&&(e=c);try{sessionStorage.removeItem(e)}catch(e){}},[c]),A=(0,o.useCallback)(d(function(e){if(!e){O();return}S(function(e){return s({},e,{loading:!0})});var t,n={};try{n=JSON.parse(sessionStorage.getItem(c)||"{}")}catch(e){}if(i&&(n=Object.keys(n).reduce(function(e,t){return n[t].maxAge-Date.now()>=0&&(e[t]=n[t]),e},{}))[e]){S({loading:!1,status:"OK",data:n[e].data});return}null==(t=k.current)||t.getPlacePredictions(s({},E.current,{input:e}),function(t,a){if(S({loading:!1,status:a,data:t||[]}),i&&"OK"===a){n[e]={data:t,maxAge:Date.now()+1e3*i};try{sessionStorage.setItem(c,JSON.stringify(n))}catch(e){}}})},void 0===a?200:a),[i,c,O,E]),I=(0,o.useCallback)(function(e,t){void 0===t&&(t=!0),_(e),k.current&&t&&A(e)},[A]);return(0,o.useEffect)(function(){if(!v)return function(){return null};var e=window.google;return N.current||null!=e&&e.maps||!f?L():window[f]=L,function(){window[f]&&delete window[f]}},[f,N,L,v]),{ready:x,value:w,suggestions:j,setValue:I,clearSuggestions:O,clearCache:D,init:L}},f=function(e){var t=new window.google.maps.Geocoder;return new Promise(function(n,a){t.geocode(e,function(t,o){"OK"!==o&&a(o),!e.address&&e.componentRestrictions&&(console.error("\uD83D\uDCA1 use-places-autocomplete: Please provide an address when using getGeocode() with the componentRestrictions."),n(t)),n(t)})})},m=function(e){var t=e.geometry.location,n=t.lat,a=t.lng;return{lat:n(),lng:a()}},g=function(){if("undefined"==typeof window||"function"!=typeof window.addEventListener)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}}),n=function(){return null};return window.addEventListener("test",n,t),window.removeEventListener("test",n,t),e},v=function(e,t){var n;return null==(n=e.classList)?void 0:n.contains(t)},h=function(e,t){for(var n=e.target||e;n;){if(Array.isArray(t)){if(t.some(function(e){return v(n,e)}))return!0}else if(v(n,t))return!0;n=n.parentElement}return!1},x=function(e){return!!(e.includes("touch")&&g())&&{passive:!0}},b=function(e,t){var n=void 0===t?{}:t,a=n.refs,r=n.disabled,i=n.eventTypes,l=void 0===i?["mousedown","touchstart"]:i,c=n.excludeScrollbar,s=n.ignoreClass,u=void 0===s?"ignore-onclickoutside":s,d=n.detectIFrame,p=void 0===d||d,f=(0,o.useState)([]),m=f[0],g=f[1],v=(0,o.useRef)(e);v.current=e;var b=(0,o.useCallback)(function(e){return g(function(t){return[].concat(t,[{current:e}])})},[]);return(0,o.useEffect)(function(){if(null!=a&&a.length||m.length){var e=function(){var e=[];return(a||m).forEach(function(t){var n=t.current;return n&&e.push(n)}),e},t=function(t){!h(t,u)&&!(c&&(document.documentElement.clientWidth<=t.clientX||document.documentElement.clientHeight<=t.clientY))&&e().every(function(e){return!e.contains(t.target)})&&v.current(t)},n=function(t){return setTimeout(function(){var n=document.activeElement;(null==n?void 0:n.tagName)!=="IFRAME"||h(n,u)||e().includes(n)||v.current(t)},0)},o=function(){l.forEach(function(e){return document.removeEventListener(e,t,x(e))}),p&&window.removeEventListener("blur",n)};if(r){o();return}return l.forEach(function(e){return document.addEventListener(e,t,x(e))}),p&&window.addEventListener("blur",n),function(){return o()}}},[m,u,c,r,p,JSON.stringify(l)]),b},y=n(9890),w=n.n(y);function _(e){let{setSelectedCoordinates:t,setSelectedPlaceName:n}=e,{ready:o,value:r,setValue:i,suggestions:{status:l,data:c},clearSuggestions:s}=p({debounce:300}),u=e=>{let{description:a}=e;return()=>{i(a,!1),s(),f({address:a}).then(e=>{let{lat:o,lng:r}=m(e[0]);console.log("\uD83D\uDCCD Coordinates: ",{lat:o,lng:r}),t({lat:o,lng:r}),n(a)})}},d=b(()=>{s()});return(0,a.jsx)("div",{className:w().container,children:(0,a.jsxs)("div",{className:w().autocomplete,ref:d,children:[(0,a.jsx)("input",{className:w().input,value:r,onChange:e=>{i(e.target.value)},disabled:!o,placeholder:"Where are you going?",type:"text",role:"combobox","aria-controls":"ex-list-box","aria-autocomplete":"list","aria-haspopup":"listbox","aria-expanded":"OK"===l}),"OK"===l&&(0,a.jsx)("ul",{id:"ex-list-box",className:w()["list-box"],role:"listbox",children:c.map(e=>{let{place_id:t,structured_formatting:{main_text:n,secondary_text:o}}=e;return(0,a.jsxs)("li",{onClick:u(e),className:w()["list-item"],role:"option",children:[(0,a.jsx)("strong",{children:n})," ",(0,a.jsx)("small",{children:o})]},t)})})]})})}let C="http://localhost:8080/maps",j={lat:49.21,lng:-122.96};function S(){let{isLoaded:e}=(0,r.Db)({googleMapsApiKey:"AIzaSyD8J3Rv_nnX4CqeWyDuFmbj33HHA6khJB8",libraries:["places"],language:"en"});return e?(0,a.jsx)(k,{}):(0,a.jsx)("div",{children:"Loading..."})}function k(){let[e,t]=(0,o.useState)(null),[n,l]=(0,o.useState)(null),[s,u]=(0,o.useState)(null),[d,p]=(0,o.useState)([]),[f,m]=(0,o.useState)(!1),g=async e=>{e.placeId?await i.Z.get(C+"/api/places/marker/search?placeId=".concat(e.placeId)).then(e=>{console.log(e.data.displayName.text),l(e.data.displayName.text)}).catch(e=>console.error(e)):l("Via Coordinates (".concat(e.latLng.lat(),", ").concat(e.latLng.lng(),")"))},v=async(e,t)=>{await i.Z.get(C+"/api/places/selected/address?lat=".concat(e,"&lng=").concat(t)).then(e=>{console.log(e.data.results[0].formatted_address),u(e.data.results[0].formatted_address)}).catch(e=>console.error(e))},h=async(e,n,a)=>{t({lat:e,lng:n}),m(a),v(e,n)},x=async e=>{h(e.latLng.lat(),e.latLng.lng(),!1),g(e)},b=async(e,t)=>{h(e.latLng.lat(),e.latLng.lng(),!0),l(t)},y=async()=>{console.log("Getting nearby places...",e.lat,e.lng),await i.Z.get(C+"/api/places/nearby/search?lat=".concat(e.lat,"&lng=").concat(e.lng)).then(e=>{console.log(e.data),p(e.data)}).catch(e=>console.error(e))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:c().placesContainer,children:(0,a.jsx)(_,{setSelectedCoordinates:t,setSelectedPlaceName:l})}),(0,a.jsxs)(r.b6,{zoom:12,center:j,mapContainerClassName:c().mapContainer,onClick:x,children:[e&&(0,a.jsx)(r.Jx,{position:e,title:n,onClick:e=>b(e,n),onDblClick:y,children:f&&(0,a.jsx)(r.nx,{position:e,children:(0,a.jsx)("div",{children:(0,a.jsx)("h4",{children:n})})})}),d.map((e,t)=>(0,a.jsx)(r.Jx,{position:{lat:e.geometry.location.lat,lng:e.geometry.location.lng},title:e.name,onClick:t=>b(t,e.name)},t))]}),(0,a.jsxs)("div",{className:c().mapCaptionContainer,children:[(0,a.jsx)("h3",{children:"\uD83D\uDCCD Selected Location:"}),(0,a.jsx)("p",{children:n})]})]})}},9890:function(e){e.exports={container:"autocomplete_container__Fjuzk",autocomplete:"autocomplete_autocomplete__nh_Mp",input:"autocomplete_input__Yj_A3","list-box":"autocomplete_list-box__BJnG_","list-item":"autocomplete_list-item__w1lZK"}},4929:function(e){e.exports={placesContainer:"map_placesContainer__xLbdq",mapContainer:"map_mapContainer__ttVnd",mapCaptionContainer:"map_mapCaptionContainer___R_Y4"}}},function(e){e.O(0,[910,908,971,69,744],function(){return e(e.s=3950)}),_N_E=e.O()}]);